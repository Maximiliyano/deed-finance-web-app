import{a as he}from"./chunk-VHH5CHZ3.js";import{a as ve}from"./chunk-K5DBSMY2.js";import{a as O}from"./chunk-TD6TFZ7C.js";import{e as xe}from"./chunk-E432CZAM.js";import{D as B,E as L,F as J,G as K,H as Q,I as W,L as X,M as Z,N as E,O as ee,P as te,Q as ie,R as x,T as ne,U as oe,V as re,W as ae,c as _,ca as se,d as R,ea as pe,f as Y,fa as le,ga as me,ha as ce,ia as de,j as H,ja as ue,k as F,ka as fe,la as ge,u as T,v as z}from"./chunk-IN42GRYJ.js";import{Ab as v,Eb as $,Jb as C,Lb as A,Sb as U,Tb as s,Ub as b,V as u,Wb as V,Xa as p,Ya as c,aa as g,ba as I,dc as q,ec as G,fa as M,j as y,la as S,ma as D,nb as f,pb as m,ua as w,va as j,yb as a,zb as o}from"./chunk-A5NZFVX5.js";var Ce=(()=>{let e=class e{constructor(){}hasError(i,n,r){return i.get(n)?.hasError(r)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var P=(()=>{let e=class e{constructor(i){this.http=i,this.baseUrl=O.apiUrl+"/api/expenses"}getAll(){return this.http.get(this.baseUrl)}add(i){return this.http.post(this.baseUrl,i)}};e.\u0275fac=function(n){return new(n||e)(M(F))},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Oe(t,e){if(t&1&&(a(0,"mat-option",15),s(1),o()),t&2){let l=e.$implicit;m("value",l.id),p(),b(l.name)}}function Pe(t,e){if(t&1&&(a(0,"mat-hint"),s(1),o()),t&2){let l=A();p(),b(l.errCapitalMsg)}}function ke(t,e){if(t&1&&(a(0,"mat-option",15),s(1),o()),t&2){let l=e.$implicit;m("value",l.id),p(),b(l.name)}}function we(t,e){if(t&1&&(a(0,"mat-hint"),s(1),o()),t&2){let l=A();p(),b(l.errCategoryMsg)}}var Ee=(()=>{let e=class e{constructor(i,n,r,d,k){this.dialogService=i,this.expenseService=n,this.popupService=r,this.dialogRef=d,this.data=k,this.$unsubscribe=new y}ngOnInit(){this.initializeForm()}ngOnDestroy(){this.$unsubscribe.next(),this.$unsubscribe.complete()}initializeForm(){this.addExpenseForm=new ie({Amount:new x("",[E.required]),CapitalId:new x("",[E.required]),CategoryId:new x("",[E.required]),PaymentDate:new x(new Date,[E.required]),Purpose:new x(null)}),this.checkAndToggleControl("CapitalId",!this.data.capitals?.length),this.checkAndToggleControl("CategoryId",!this.data.categories?.length)}checkAndToggleControl(i,n){let r=this.addExpenseForm.get(i);n?(r.disabled||(r.disable(),r.setErrors({required:!0,message:"The control is required."})),i==="CapitalId"?this.errCapitalMsg="You don't have any capitals assigned to your account.":i==="CategoryId"&&(this.errCategoryMsg="You don't have any categories assigned to your account.")):(r.enable(),i==="CapitalId"?this.errCapitalMsg=null:i==="CategoryId"&&(this.errCategoryMsg=null))}add(){if(!this.data.capitals.length||!this.data.categories.length){this.popupService.error("The capitals or categories was not found.");return}let i={capitalId:this.addExpenseForm.value.CapitalId,categoryId:this.addExpenseForm.value.CategoryId,amount:this.addExpenseForm.value.Amount,paymentDate:this.addExpenseForm.value.PaymentDate,purpose:this.addExpenseForm.value.Purpose};this.expenseService.add(i).pipe(u(this.$unsubscribe)).subscribe({next:()=>{this.popupService.success("The expense is successfully added."),this.onCancel(!0)},error:()=>this.onCancel(!1)})}onCancel(i=!1){this.dialogRef.close(i)}hasError(i,n){return this.dialogService.hasError(this.addExpenseForm,i,n)}};e.\u0275fac=function(n){return new(n||e)(c(Ce),c(P),c(ve),c(B),c(L))},e.\u0275cmp=S({type:e,selectors:[["app-expenses-dialog"]],decls:38,vars:8,consts:[["picker",""],[3,"formGroup"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],["matInput","","placeholder","Amount","type","number","formControlName","Amount"],["formControlName","CapitalId"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","CategoryId"],["matInput","","formControlName","PaymentDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","Purpose"],["mat-dialog-actions",""],["mat-button","",3,"click","disabled"],["mat-button","",3,"click"],[3,"value"]],template:function(n,r){if(n&1){let d=$();a(0,"form",1)(1,"h1",2),s(2,"Add expense"),o(),a(3,"div",3)(4,"mat-form-field")(5,"mat-label"),s(6,"Amount"),o(),v(7,"input",4),o(),a(8,"mat-form-field")(9,"mat-label"),s(10,"Select capital"),o(),a(11,"mat-select",5),f(12,Oe,2,2,"mat-option",6),o(),f(13,Pe,2,1,"mat-hint",7),o(),a(14,"mat-form-field")(15,"mat-label"),s(16,"Select category"),o(),a(17,"mat-select",8),f(18,ke,2,2,"mat-option",6),o(),f(19,we,2,1,"mat-hint",7),o(),a(20,"mat-form-field")(21,"mat-label"),s(22,"Choose a payment date"),o(),v(23,"input",9),a(24,"mat-hint"),s(25,"MM/DD/YYYY"),o(),v(26,"mat-datepicker-toggle",10)(27,"mat-datepicker",null,0),o(),a(29,"mat-form-field")(30,"mat-label"),s(31,"Purpose"),o(),v(32,"textarea",11),o()(),a(33,"div",12)(34,"button",13),C("click",function(){return w(d),j(r.add())}),s(35,"Save"),o(),a(36,"button",14),C("click",function(){return w(d),j(r.onCancel())}),s(37,"Cancel"),o()()()}if(n&2){let d=U(28);m("formGroup",r.addExpenseForm),p(12),m("ngForOf",r.data.capitals),p(),m("ngIf",r.errCapitalMsg),p(5),m("ngForOf",r.data.categories),p(),m("ngIf",r.errCategoryMsg),p(4),m("matDatepicker",d),p(3),m("for",d),p(8),m("disabled",!r.addExpenseForm.valid)}},dependencies:[_,R,X,me,se,pe,le,ce,z,de,ue,fe,ge,K,W,Q,ne,Z,oe,ee,te,re,ae],styles:[".dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;gap:5px}"]});let t=e;return t})();var N=function(t){return t[t.None=0]="None",t[t.Expenses=1]="Expenses",t[t.Incomes=2]="Incomes",t}(N||{});var ye=(()=>{let e=class e{constructor(i){this.http=i,this.baseApiUrl=O.apiUrl+"/api/categories"}getAll(i=null){let n=new H;return i!=null&&(n=n.set("type",i)),this.http.get(this.baseApiUrl,{params:n})}};e.\u0275fac=function(n){return new(n||e)(M(F))},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ae(t,e){if(t&1&&(a(0,"div",7),s(1),q(2,"date"),o()),t&2){let l=e.$implicit;p(),V(" Amount: ",l.amount," PaymentDate: ",G(2,3,l.paymentDate)," Purpose: ",l.purpose," ")}}var Ie=(()=>{let e=class e{constructor(i,n,r,d){this.capitalService=i,this.categoryService=n,this.expenseService=r,this.dialog=d,this.$unsubscribe=new y}ngOnInit(){this.capitalService.getAll().pipe(u(this.$unsubscribe)).subscribe({next:i=>this.capitals=i}),this.categoryService.getAll(N.Expenses).pipe(u(this.$unsubscribe)).subscribe({next:i=>this.categories=i}),this.loadExpenses()}ngOnDestroy(){this.$unsubscribe.next(),this.$unsubscribe.complete()}loadExpenses(){this.expenseService.getAll().pipe(u(this.$unsubscribe)).subscribe({next:i=>this.expenses=i.map(n=>((n.purpose==null||n.purpose=="")&&(n.purpose="-"),n))})}add(){this.dialog.open(Ee,{data:{categories:this.categories,capitals:this.capitals}}).afterClosed().pipe(u(this.$unsubscribe)).subscribe(n=>{n&&this.loadExpenses()})}};e.\u0275fac=function(n){return new(n||e)(c(he),c(ye),c(P),c(J))},e.\u0275cmp=S({type:e,selectors:[["app-expenses"]],decls:10,vars:1,consts:[[1,"expenses-container"],[1,"expenses-header"],[1,"expenses-content"],["class","expense",4,"ngFor","ngForOf"],[1,"expenses-actions"],[1,"exp-item"],[3,"click"],[1,"expense"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1),s(2," Expenses "),o(),a(3,"div",2),s(4," Expenses: "),f(5,Ae,3,5,"div",3),o(),a(6,"div",4)(7,"div",5)(8,"button",6),C("click",function(){return r.add()}),s(9," Add Expense "),o()()()()),n&2&&(p(5),m("ngForOf",r.expenses))},dependencies:[_,Y],styles:[".expenses-container[_ngcontent-%COMP%]{margin-top:20px}.expenses-container[_ngcontent-%COMP%]   .expenses-header[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;align-items:center;border-bottom:1px solid #ccc;padding:10px 15px;font-size:24px;font-weight:500}.expenses-container[_ngcontent-%COMP%]   .expenses-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px}.expenses-container[_ngcontent-%COMP%]   .expenses-content[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%], .expenses-container[_ngcontent-%COMP%]   .expenses-content[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#e6e6e6;border-radius:5px;border:1px solid #ccc;transition:background-color .3s ease-out;padding:15px;position:relative;gap:5px;cursor:pointer}.expenses-container[_ngcontent-%COMP%]   .expenses-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px;margin-top:15px}.expenses-container[_ngcontent-%COMP%]   .expenses-actions[_ngcontent-%COMP%]   .exp-item[_ngcontent-%COMP%]{cursor:pointer}"]});let t=e;return t})();var Te=[{path:"",component:Ie}],Me=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=D({type:e}),e.\u0275inj=I({imports:[T.forChild(Te),T]});let t=e;return t})();var gt=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=D({type:e}),e.\u0275inj=I({imports:[Me,xe]});let t=e;return t})();export{gt as ExpenseModule};
